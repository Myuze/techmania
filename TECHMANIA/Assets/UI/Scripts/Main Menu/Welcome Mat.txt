function InitializeWelcomeMat(tm)
    local mainMenu = tm.root.Q("main-menu")
    local buttons = mainMenu.Q("buttons")
    local mat = mainMenu.Q("welcome-mat")
    mainMenu.display = true
    mainMenu.visible = true
    buttons.display = true
    buttons.visible = false
    mat.display = true
    mat.visible = true

    local slowBlinking = true

    function Blink(timer, period)
        local opacity = mathf.PingPong(timer, period) / period
        local smoothOpacity = mathf.SmoothStep(0, 1, opacity)
        mat.style.opacity = tm.style.Float(smoothOpacity)
    end
    function SlowBlink()
        local matTimer = 0
        local period = 1.5
        while (true) do
            Blink(matTimer, period)
            matTimer = matTimer + time.deltaTime
            coroutine.yield()
        end
    end
    function FastBlinkThenShowMenu()
        local matTimer = 0
        local period = 0.2
        while (matTimer < period * 6) do
            Blink(matTimer, period)
            matTimer = matTimer + time.deltaTime
            coroutine.yield()
        end
        WaitForSeconds(0.2)
        mat.display = false
        buttons.visible = true
    end

    local slowBlinkCoroutine = tm.StartCoroutine(SlowBlink)
    mat.RegisterCallback("Click", function ()
        if (not slowBlinking) then return end
        slowBlinking = false
        tm.StopCoroutine(slowBlinkCoroutine)
        tm.audio.PlayFileInTheme("Assets/UI/SFX/Game Start.wav", "SFX")
        tm.StartCoroutine(FastBlinkThenShowMenu)
    end)
end

InitializeWelcomeMat(tm)