function SetUpNavigation()
    tm.root.Q("main-menu").Q("start-button").RegisterCallback(eventType.Click, function()
        TransitionPanelFromRight(
            tm.root.Q("main-menu"),
            tm.root.Q("select-track-panel")
        )
        ShowSelectTrackPanel()
    end)
    tm.root.Q("select-track-panel").Q("back-button").RegisterCallback(eventType.Click, function()
        TransitionPanelFromLeft(
            tm.root.Q("select-track-panel"),
            tm.root.Q("main-menu")
        )
    end)
    -- select track panel --> select pattern panel is registered on track cards,
    -- handled by Select Track Panel.txt
    tm.root.Q("select-pattern-panel").Q("back-button").RegisterCallback(eventType.Click, function()
        TransitionPanelFromLeft(
            tm.root.Q("select-pattern-panel"),
            tm.root.Q("select-track-panel")
        )
        StopPreviewTrackPlayback()
    end)
    tm.root.Q("select-pattern-panel").Q("play-button").RegisterCallback(eventType.Click, function()
        FadeOutThenInToPanel(
            tm.root.Q("select-pattern-panel"),
            tm.root.Q("game-panel"),
            function()
                -- Only start loading after the game panel appears, in order
                -- for layout to work.
                tm.game.BeginLoading()
            end
        )
        StopPreviewTrackPlayback()
    end)
    tm.root.Q("main-menu").Q("options-button").RegisterCallback(eventType.Click, function()
        TransitionPanelFromRight(
            tm.root.Q("main-menu"),
            tm.root.Q("options-panel")
        )
        ShowOptionsPanel()
    end)
    tm.root.Q("options-panel").Q("back-button").RegisterCallback(eventType.Click, function()
        TransitionPanelFromLeft(
            tm.root.Q("options-panel"),
            tm.root.Q("main-menu")
        )
        tm.options.SaveToFile()
    end)
    tm.root.Q("main-menu").Q("information-button").RegisterCallback(eventType.Click, function()
        TransitionPanelFromRight(
            tm.root.Q("main-menu"),
            tm.root.Q("information-panel")
        )
    end)
    tm.root.Q("information-panel").Q("back-button").RegisterCallback(eventType.Click, function()
        TransitionPanelFromLeft(
            tm.root.Q("information-panel"),
            tm.root.Q("main-menu")
        )
    end)
    tm.root.Q("main-menu").Q("quit-button").RegisterCallback(eventType.Click, function()
        tm.Quit()
    end)
end

function SelectTrackToSelectPatternPanel()
    TransitionPanelFromRight(
        tm.root.Q("select-track-panel"),
        tm.root.Q("select-pattern-panel"),
        function()
            -- This has to be called 1 frame after select-pattern-panel
            -- displays so the radar can be initialized properly.
            InitializeRadar()
            -- This has to be called after select-pattern-panel displays
            -- so the load audio callback can check whether the panel
            -- displays to decide whether to play the audio.
            StartPreviewTrackPlayback()
        end
    )
    ShowSelectPatternPanel()
end

function GamePanelToSelectTrackPanel()
    FadeOutThenInToPanel(
        tm.root.Q("game-panel"),
        tm.root.Q("select-track-panel"),
        function()
            -- This causes the BGA to unload so it should happen
            -- after the game panel has faded out.
            tm.game.Conclude()
        end
    )
    ShowSelectTrackPanel()
end