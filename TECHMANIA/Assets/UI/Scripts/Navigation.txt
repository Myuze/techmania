function SetUpNavigation()
    local mainMenu = tm.root.Q("main-menu")

    mainMenu.Q("start-button").RegisterCallback(eventType.Click, function()
        panelTransition.FromRight(
            mainMenu,
            selectTrackPanel.panel
        )
        selectTrackPanel.Show()
    end)
    selectTrackPanel.panel.Q("back-button").RegisterCallback(eventType.Click, function()
        panelTransition.FromLeft(
            selectTrackPanel.panel,
            mainMenu
        )
    end)
    -- select track panel --> select pattern panel is registered on track cards,
    -- handled by Select Track Panel.txt
    selectPatternPanel.panel.Q("back-button").RegisterCallback(eventType.Click, function()
        panelTransition.FromLeft(
            selectPatternPanel.panel,
            selectTrackPanel.panel
        )
        selectPatternPanel.StopPreviewTrackPlayback()
    end)
    selectPatternPanel.panel.Q("play-button").RegisterCallback(eventType.Click, function()
        panelTransition.FadeToBlack(
            selectPatternPanel.panel,
            gamePanel.panel,
            function()
                -- Only start loading after the game panel appears, in order
                -- for layout to work.
                tm.game.BeginLoading()
            end
        )
        selectPatternPanel.StopPreviewTrackPlayback()
    end)
    mainMenu.Q("options-button").RegisterCallback(eventType.Click, function()
        panelTransition.FromRight(
            mainMenu,
            optionsPanel.panel
        )
        optionsPanel.Show()
    end)
    optionsPanel.panel.Q("back-button").RegisterCallback(eventType.Click, function()
        panelTransition.FromLeft(
            optionsPanel.panel,
            mainMenu
        )
        tm.options.SaveToFile()
    end)
    mainMenu.Q("information-button").RegisterCallback(eventType.Click, function()
        panelTransition.FromRight(
            mainMenu,
            infoPanel.panel
        )
    end)
    infoPanel.panel.Q("back-button").RegisterCallback(eventType.Click, function()
        panelTransition.FromLeft(
            infoPanel.panel,
            mainMenu
        )
    end)
    mainMenu.Q("quit-button").RegisterCallback(eventType.Click, function()
        tm.Quit()
    end)
end

function SelectTrackToSelectPatternPanel()
    panelTransition.FromRight(
        selectTrackPanel.panel,
        selectPatternPanel.panel,
        function()
            -- This has to be called 1 frame after selectPatternPanel
            -- displays so the radar can be initialized properly.
            selectPatternPanel.InitializeRadar()
            -- This has to be called after selectPatternPanel displays
            -- so the load audio callback can check whether the panel
            -- displays to decide whether to play the audio.
            selectPatternPanel.StartPreviewTrackPlayback()
        end
    )
    selectPatternPanel.Show()
end

function GamePanelToSelectTrackPanel()
    panelTransition.FadeToBlack(
        gamePanel.panel,
        selectTrackPanel.panel,
        function()
            -- This causes the BGA to unload so it should happen
            -- after the game panel has faded out.
            if (tm.game.state != tm.enum.gameState.Idle) then
                tm.game.Conclude()
            end
        end
    )
    selectTrackPanel.Show()
end